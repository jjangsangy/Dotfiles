#!/usr/bin/env bash

function outdated() {
    # List out outdated python packages delimited by newline
    pip list --outdated \
        | sed \
            -e 's/(.*//g' \
            -e '/^Could/ d' \
            -e '/^Some/ d'
}

main() {
    echo "Unpacking outdated packages"
    declare -a list=( $(outdated) )

    # Loop through each package and install upgrade
    for ((i=0; i<${#list[@]}; i++)); do
        printf "Installing Package: %-20s" "${list[i]}"

        # Checks for successful installation
        if [ "$(pip install --upgrade "${list[i]}" &>/dev/null)" ]; then
            printf "$(tput setaf 2)%s$(tput sgr0)\n" "Success"
        else
            printf "$(tput setaf 1)%s$(tput sgr0)\n" "Failed"
        fi
    done
}

if [[ "$0" == "${BASH_SOURCE}" ]]; then
    main
fi
